*&---------------------------------------------------------------------*
*& Report  ZMMCGB_0002
*&
*&---------------------------------------------------------------------*
REPORT zmmcgb_0002 LINE-SIZE 200 LINE-COUNT 60 MESSAGE-ID zmm
NO STANDARD PAGE HEADING.
*----------------------------------------------------------------------*
* Title   : Data Migration
* FRICE#  : MM_05
* Author  : Thinh Tran
* Date    : 13 Jun 2018
* Purpose : Upload source list
* Specification Given By: NA
*----------------------------------------------------------------------*
*----------------------------------------------------------------------*
*  MODIFICATION LOG
*-----------------------------------------------------------------------
*  DATE     change #         Programmer  Description.
*-----------------------------------------------------------------------

*----------------------------------------------------------------------*
* I N C L U D E S
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
* T Y P E P O O L S
*----------------------------------------------------------------------*
*TYPE-POOLS: truxs,ehsww.

*----------------------------------------------------------------------*
* T A B L E S
*----------------------------------------------------------------------*
*TABLES : mara.

*----------------------------------------------------------------------*
* I N T E R N A L   T A B L E S
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
* R A N G E S
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
*  P A R A M E T E R S  &  S E L E C T - O P T I O N S
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
* I N I T I A L I Z A T I O N
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
* A T  S E L E C T I O N  S C R E E N
*----------------------------------------------------------------------*
PARAMETERS: p_file TYPE string.

*----------------------------------------------------------------------*
* A T  S E L E C T I O N  S C R E E N OUTPUT
*----------------------------------------------------------------------*
AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_file.
  PERFORM f_file_open_dialog.
*----------------------------------------------------------------------*
* A T  L I N E  S E L E C T I O N
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
* A T    U S E R   C O M M A N D
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
* S T A R T   O F   S E L E C T I O N
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Form  F_FILE_OPEN_DIALOG
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM f_file_open_dialog .
  DATA: lv_filename	TYPE string,
        lv_path	    TYPE string,
        lv_fullpath	TYPE string,
        lt_filetab  TYPE FILETABLE,
        lv_rc       TYPE i.
CALL METHOD cl_gui_frontend_services=>file_open_dialog
  EXPORTING
    window_title            = 'Choose file'
    file_filter             = 'Excel files (*.xls;*.xlsx)|*.xls;*.xlsx|All Files (*.*)|*.*'
  CHANGING
    file_table              = lt_filetab
    rc                      = lv_rc
  EXCEPTIONS
    file_open_dialog_failed = 1
    cntl_error              = 2
    error_no_gui            = 3
    not_supported_by_gui    = 4
    others                  = 5.
  IF sy-subrc = 0.
    p_file = lv_filename.
*   Implement suitable error handling here
  ENDIF.

ENDFORM.
